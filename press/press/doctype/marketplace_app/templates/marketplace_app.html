{% extends "templates/marketplace/base.html" %}
{%- from "templates/marketplace/macros.html" import button, link, breadcrumbs, badge -%}

{%- block body -%}
<div>
	<div class="px-4 sm:px-8">
		<div class="mt-5">
			{{ breadcrumbs([
			{ 'label': 'Apps', 'url': '/marketplace' },
			{ 'label': category.name, 'url': '' },
			{ 'label': app.title, 'url': '' }
			]) }}
		</div>

		<div class="flex pt-4 pb-8 space-x-4 sm:space-x-10">
			{{ sidebar() }}
			{{ main() }}
		</div>

		<div class="flex flex-col-reverse items-center pb-8 sm:space-x-8 sm:flex-row sm:pb-0 sm:items-start">
			<div class="grid self-start grid-cols-2 gap-x-4 gap-y-8 sm:space-y-8 sm:block">

			</div>


		</div>
	</div>
</div>
{%- endblock -%}

{% macro sidebar() %}
<div class="w-44 space-y-9">
	<div class="w-24 h-24 sm:w-44 sm:h-44">
		{%- if app.image -%}
		<img class="object-cover border border-gray-200 rounded-lg"
			src="{{ app.image }}" alt="{{ app.title }}">
		{%- else -%}
		<div class="flex items-center justify-center text-gray-500 bg-gray-100 border border-gray-200 rounded-lg">
			{{ app.title[0].upper() }}
		</div>
		{%- endif -%}
	</div>
	<div>
		<h5 class="text-xl font-semibold text-gray-900">Category</h5>
		<div class="mt-2">
			<!-- Hard-coded for now -->
			{{ badge('Free') }}
			{{ badge(app.category) }}
		</div>
	</div>
	<div>
		<h5 class="text-xl font-semibold text-gray-900">Learn more & Support</h5>
		<ul class="flex flex-col mt-2 space-y-3">
			{%- for label, icon, href in [
			('Visit Website', 'external-link', app.website),
			('Support', 'life-buoy', app.support),
			('Documentaion', 'file-text', app.documentation),
			('Privacy Policy', 'lock', app.privacy_policy),
			('Terms of Service', 'shield', app.terms_of_service)
			] -%}
			{%- if href -%}
			<li>
				<a class="flex flex-row space-x-1 text-gray-600 hover:text-gray-800" href="{{ href }}">
					<i class="w-4 h-4" data-feather="{{ icon }}"></i>
					<span class="text-base">{{ label }}</span>
				</a>
			</li>
			{%- endif -%}
			{%- endfor -%}
		</ul>
	</div>
	<div>
		<h5 class="text-xl font-semibold text-gray-900">Publisher</h5>
		<!-- TODO: Replace with the publisher data (to be modeled) -->
		<a class="text-base text-blue-500 hover:text-blue-700" href="mailto:{{ app.team }}">{{ app.team
			}}</a>
	</div>
	<div>
		<h5 class="text-xl font-semibold text-gray-900">Supported Versions</h5>
		<ul class="mt-2 space-y-1 text-base text-gray-600">
			{%- for group in groups -%}
			<li>
				{{ link(group.version, group.frappe.repository_url + '/tree/' + group.frappe.branch,
				blank=True) }}
			</li>
			{%- endfor -%}
		</ul>
	</div>
</div>
{% endmacro %}


{% macro main() %}
<div class="w-full">
	<div class="flex flex-row items-center justify-between">
		<h1 class="mb-2 text-4xl font-semibold text-gray-900 sm:text-5xl"> {{ app.title }} </h1>
		<div>
			{{ button('Install Now', '/dashboard/sites/new', 'primary') }}
		</div>
	</div>
	<p class="text-base text-gray-700">
		{{ app.description }}
	</p>
	<div class="flex mt-6 space-x-4 overflow-y-auto">
		{%- for image in app.screenshots -%}
		<div class="flex-shrink-0 overflow-hidden border rounded-md h-60 w-80">
			<a href="{{ image.image }}">
				<img class="object-cover w-full h-full" src="{{ image.image }}" alt="{{ image.caption }}" />
			</a>
		</div>
		{%- endfor -%}
	</div>
	<div class="w-full pb-8 mt-6 prose-sm prose text-gray-900">
		{{ frappe.utils.md_to_html(app.long_description) }}
	</div>
</div>
{% endmacro %}

